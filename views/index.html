<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>URL SHORTER</title>
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@5.x/css/materialdesignicons.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
    <link rel="stylesheet" href="assets/style.css">
</head>

<body>
    <div id="app">
        <v-container>
            <v-row align="center" justify="center">
                <v-col sm="12" md="12" lg="6">
                    <v-row justify="center" align="center">
                        <v-img src="assets/3918929-min.png"></v-img>
                    </v-row>
                </v-col>
                <v-col sm="12" md="12" lg="6">
                    <v-card>
                        <v-row align="center" class="pa-form">
                            <v-col cols="12" class="justify-center">
                                <h2 class="title">SHORT YOUR URL</h2>
                                <p class="subtitle">MAKE EVERYONE EASY ACCESS YOUR WEBSITE</p>
                                <v-text-field v-model="redirectUrl" color="primary" outlined placeholder="Your Link"
                                    append-icon="mdi-link" :disabled="isLoading" regular rounded>
                                </v-text-field>
                                <v-text-field v-model="customUrl" v-if="isCustom" outlined placeholder="Custom URL"
                                    append-icon="mdi-link" rounded :disabled="isLoading" regular>
                                </v-text-field>
                                <v-checkbox v-model="isCustom" :label="`Custom URL`"></v-checkbox>
                                <v-btn block :loading="isLoading" :disabled="isLoading" color="success"
                                    @click="store()">
                                    Custom Loader
                                    <template v-slot:loader>
                                        <span>Loading...</span>
                                    </template>
                                </v-btn>
                                <div v-if="isDone">
                                    <v-text-field class="result-box" solo disabled append-icon="mdi-link-variant"
                                        :value="`${domain}/${shortValue}`">
                                    </v-text-field>
                                    <v-row>
                                        <v-col cols="6">
                                            <v-btn block text @click="copyClipboard()">Copy Clipboard
                                            </v-btn>
                                        </v-col>
                                        <v-col cols="6" @click="openLink()">
                                            <v-btn block text>Go To Link
                                            </v-btn>
                                        </v-col>
                                    </v-row>
                                </div>

                            </v-col>
                        </v-row>
                    </v-card>
                </v-col>
            </v-row>
        </v-container>
        <v-snackbar v-model="snackbar" :timeout="timeout">
            {{ snackbarText }}
            <template v-slot:action="{ attrs }">
                <v-btn color="blue" text v-bind="attrs" @click="snackbar = false">
                    Close
                </v-btn>
            </template>
        </v-snackbar>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/vue"></script>
    <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
        let app = new Vue({
            el: "#app",
            data: {
                snackbarText: "",
                redirectUrl: "",
                snackbar: false,
                timeout: 1500,
                customUrl: "",
                isCustom: false,
                domain: `${window.location.hostname}`,
                isLoading: false,
                shortValue: "",
                isDone: false
            },
            methods: {
                async store() {
                    this.isLoading = true
                    await axios.post("/store-url", {
                        shortUrl: this.customUrl == "" ? null : this.customUrl,
                        redirectUrl: this.redirectUrl
                    })
                        .then((result) => {
                            this.isDone = true
                            this.isLoading = false
                            this.shortValue = `${result.data.data.shortUrl}`
                        }).catch((err) => {
                            this.snackbarText = "Something is Error"
                            this.snackbar = true
                        });
                },
                copyClipboard() {
                    let textCopy = this.shortValue
                    document.execCommand("copy", textCopy)
                    this.snackbarText = "copy to clipboard"
                    this.snackbar = true
                },
                openLink() {
                    window.open(`${this.shortValue}`)
                }
            },
            vuetify: new Vuetify({})
        })
    </script>
</body>

</html>